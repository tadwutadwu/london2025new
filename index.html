<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Priceless London</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .card-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out, padding 0.5s ease-out;
            padding: 0 1.5rem;
        }
        .card.active .card-details {
            max-height: 2000px; /* Adjust as needed */
            padding: 1.5rem;
        }
        .card.active .arrow-icon {
            transform: rotate(180deg);
        }
        .arrow-icon {
            transition: transform 0.3s ease-in-out;
        }
        .card-header, .card-content {
            transition: color 0.3s ease-in-out;
        }
        .card-summary {
            transition: color 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <div class="flex flex-col sm:flex-row justify-between items-center mb-4">
                <h1 id="main-title" class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4 sm:mb-0">Priceless London</h1>
                <button id="lang-toggle" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-transform transform hover:scale-105">
                    English
                </button>
            </div>
        </header>

        <main id="itinerary-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Day cards will be inserted here by JavaScript -->
        </main>

        <section id="tools-section" class="mt-12 bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg">
             <h2 id="tools-title" class="text-2xl font-bold text-center mb-6 text-gray-900 dark:text-white">实用工具</h2>
             <div id="currency-converter" class="max-w-md mx-auto">
                <h3 id="converter-title" class="text-xl font-semibold mb-4 text-center">实时汇率计算器</h3>
                <div class="flex items-center space-x-4 bg-gray-100 dark:bg-gray-700 p-4 rounded-lg">
                    <div class="flex-1">
                        <label for="gbp-input" class="block text-sm font-medium text-gray-700 dark:text-gray-300">GBP (£)</label>
                        <input type="number" id="gbp-input" placeholder="100" class="mt-1 block w-full bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    <div class="pt-6">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                        </svg>
                    </div>
                    <div class="flex-1">
                        <label for="cny-output" class="block text-sm font-medium text-gray-700 dark:text-gray-300">CNY (¥)</label>
                        <input type="text" id="cny-output" readonly class="mt-1 block w-full bg-gray-200 dark:bg-gray-800 border border-gray-300 dark:border-gray-500 rounded-md shadow-sm py-2 px-3">
                    </div>
                </div>
                <p id="rate-display" class="text-center text-sm text-gray-500 mt-2">正在加载汇率...</p>
            </div>
        </section>

    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const translations = {
        zh: {
            mainTitle: "Priceless London",
            langButton: "English",
            toolsTitle: "实用工具",
            converterTitle: "实时汇率计算器",
            rateLoading: "正在加载汇率...",
            rateLoaded: (rate) => `当前汇率: 1 GBP ≈ ${rate.toFixed(2)} CNY`,
            rateError: "汇率加载失败，使用备用汇率。",
            days: [
                {
                    date: "10月7日, 星期二",
                    title: "抵达与安顿",
                    summary: "从伯明翰抵达，入住新居，傍晚悠闲漫步于泰晤士河畔。",
                    details: `
                        <h4 class="font-bold mb-2">交通安排:</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>火车:</b> 从伯明翰新街站乘坐Avanti West Coast列车至伦敦尤斯顿站 (约1.5-2小时)。</li>
                            <li><b>地铁:</b> 从尤斯顿站搭乘北线(Northern Line)至老街站(Old Street Station)，出站后步行至Quaker Court on Banner Street。</li>
                            <li><b>省钱技巧:</b> 提前预订火车票并研究“分段购票”(Split Ticketing)可大幅节省费用。</li>
                        </ul>
                        <h4 class="font-bold mb-2">傍晚活动:</h4>
                        <p class="mb-4">安顿后，可步行前往附近的伦敦塔和伦敦塔桥欣赏其宏伟外观，随后沿着泰晤士河漫步至圣凯瑟琳码头和巴特勒码头，感受伦敦的初夜景致。</p>
                        <h4 class="font-bold mb-2">晚餐推荐:</h4>
                        <ul class="list-disc list-inside space-y-1">
                            <li><b>The Dickens Inn:</b> 位于圣凯瑟琳码头，在历史悠久的木制建筑内享用经典英式菜肴。</li>
                            <li><b>Wright Brothers:</b> 巴特勒码头附近著名的海鲜餐厅，生蚝和海鲜拼盘是其特色。</li>
                        </ul>
                    `
                },
                {
                    date: "10月8日, 星期三",
                    title: "皇家、购物与公园",
                    summary: "观赏卫兵换岗，漫步皇家公园，沉浸于艺术与设计的殿堂，体验顶级购物，晚餐享用龙虾或汉堡。",
                    details: `
                        <h4 class="font-bold mb-2">上午活动: 白金汉宫 & 威斯敏斯特</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>交通:</b> 从利物浦街站乘地铁至格林公园站(Green Park)，步行至白金汉宫。</li>
                            <li><b>卫兵换岗:</b> 上午11:00观看仪式，建议10:30前抵达以占据有利位置 (免费活动)。</li>
                            <li><b>教堂外观:</b> 仪式后步行约15分钟，欣赏威斯敏斯特教堂和国会大厦的宏伟外观。</li>
                        </ul>
                         <h4 class="font-bold mb-2">下午活动: V&A博物馆 & 哈罗德百货</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>交通:</b> 从威斯敏斯特站乘地铁至南肯辛顿站(South Kensington)。</li>
                            <li><b>V&A博物馆:</b> 探索世界领先的艺术与设计收藏 (免费，建议官网预定免费定时票)。</li>
                            <li><b>哈罗德百货:</b> 从V&A步行可达，体验全球最著名的百货公司之一。</li>
                        </ul>
                        <h4 class="font-bold mb-2">晚餐预订:</h4>
                        <p><b>Burger and Lobster</b> (骑士桥店): 位于哈罗德百货对面，距离您下午的行程很近。建议提前预订以确保有位置。</p>
                    `
                },
                {
                    date: "10月9日, 星期四",
                    title: "文化、学术与戏剧",
                    summary: "沉浸于大英博物馆的丰富馆藏，探索西区，夜晚欣赏世界级音乐剧。",
                    details: `
                        <h4 class="font-bold mb-2">上午活动: 大英博物馆</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>交通:</b> 从利物浦街站乘中央线(Central Line)至托特纳姆法院路站(Tottenham Court Road)。</li>
                            <li><b>参观:</b> 探索世界级的馆藏，如罗塞塔石碑和埃及木乃伊 (免费，建议官网预定免费定时票)。</li>
                        </ul>
                        <h4 class="font-bold mb-2">下午活动: 西区深度探索</h4>
                        <p class="mb-4">从大英博物馆出发，步行探索伦敦政治经济学院(LSE)，然后在科芬园(Covent Garden)的福伊尔斯书店(Foyles)享受阅读时光，最后在Soho区的活力街巷中自由漫步。</p>
                        <h4 class="font-bold mb-2">夜晚活动: 音乐剧 & 晚餐</h4>
                        <ul class="list-disc list-inside space-y-1">
                             <li><b>音乐剧:</b> 欣赏经典剧目《歌剧魅影》。建议通过官网或TodayTix应用提前订票。</li>
                             <li><b>晚餐推荐:</b> 在考文特花园或苏活区附近选择一家餐厅，这里有很多不错的选择。</li>
                        </ul>
                    `
                },
                {
                    date: "10月10日, 星期五",
                    title: "剑桥一日游与晚餐",
                    summary: "短暂告别都市喧嚣，前往世界顶尖学府，体验康河撑船的独特魅力，晚上在伦敦享用日式烤串。",
                    details: `
                        <h4 class="font-bold mb-2">交通安排:</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>火车:</b> 从伦敦国王十字车站(King's Cross)乘直达火车至剑桥 (约48分钟)。</li>
                            <li><b>省钱技巧:</b> 提前购票并使用“分段购票”(split ticketing)策略。</li>
                        </ul>
                        <h4 class="font-bold mb-2">下午活动:</h4>
                         <p class="mb-4">抵达后，游览著名的国王学院和三一学院，然后在体验标志性的康河撑船(Punting)，从水上欣赏叹息桥等景点。</p>
                        <h4 class="font-bold mb-2">餐饮推荐:</h4>
                        <ul class="list-disc list-inside space-y-1">
                            <li><b>The Eagle:</b> 历史悠久的酒吧，以其炸鱼薯条和二战历史闻名。</li>
                            <li><b>Fitzbillies:</b> 品尝其招牌的切尔西小面包(Chelsea Buns)。</li>
                        </ul>
                        <h4 class="font-bold mb-2">晚餐预订:</h4>
                        <p><b>Sticks'n'Sushi - Islington</b>, 10月10日, 19:15, 4人 (已预订，确认号: 19438)。</p>
                    `
                },
                {
                    date: "10月11日, 星期六",
                    title: "艺术、美食与水岸",
                    summary: "欣赏世界名画，在伦敦最著名的美食市场大快朵颐，傍晚漫步泰晤士河南岸。",
                    details: `
                        <h4 class="font-bold mb-2">上午活动: 国家美术馆</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>交通:</b> 从利物浦街站乘地铁至查令十字站(Charing Cross)。</li>
                            <li><b>参观:</b> 欣赏梵高、莫奈等大师的杰作 (免费，建议官网预定免费票)。建议预留至少3小时。</li>
                        </ul>
                        <h4 class="font-bold mb-2">下午活动: 博罗市场 & 南岸漫步</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                             <li><b>交通:</b> 从查令十字站乘朱比利线(Jubilee Line)至伦敦桥站(London Bridge)。</li>
                            <li><b>美食之旅:</b> 在博罗市场(Borough Market)品尝猪肉卷、烤芝士三明治、新鲜生蚝和3bis的意式冰淇淋。</li>
                            <li><b>漫步:</b> 沿着泰晤士河南岸，从Southwark步行至Waterloo，途经莎士比亚环球剧场和泰特现代艺术馆。</li>
                        </ul>
                         <h4 class="font-bold mb-2">晚餐预订:</h4>
                        <p><b>Blacklock Shoreditch</b>, 10月11日, 19:45, 3人 (已预订，确认号: 2109994835)</p>
                    `
                },
                {
                    date: "10月12日, 星期日",
                    title: "市场与启程",
                    summary: "在东伦敦最热闹的市集感受多元文化，随后轻松前往机场，结束旅程。",
                    details: `
                        <h4 class="font-bold mb-2">上午活动: 布里克巷市集</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>交通:</b> 从您的住所步行即可到达，非常便利。</li>
                            <li><b>亮点:</b> 周日的布里克巷(Brick Lane)市集最为热闹，充满了复古服饰、独立设计和世界各地的街头美食。</li>
                            <li><b>美食推荐:</b> 务必尝试Beigel Bake的咸牛肉贝果和地道的孟加拉国咖喱。</li>
                        </ul>
                        <h4 class="font-bold mb-2">下午活动: 前往机场</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>时间规划:</b> 您的航班CX250于18:20从希思罗机场T3航站楼起飞。建议最晚于15:00从住所出发。</li>
                            <li><b>交通:</b> 从利物浦街站乘坐伊丽莎白线(Elizabeth Line)直达希思罗机场 (约35分钟)。</li>
                        </ul>
                    `
                },
            ]
        },
        en: {
            mainTitle: "Priceless London",
            langButton: "中文",
            toolsTitle: "Useful Tools",
            converterTitle: "Live Exchange Rate Converter",
            rateLoading: "Loading rate...",
            rateLoaded: (rate) => `Current Rate: 1 GBP ≈ ${rate.toFixed(2)} CNY`,
            rateError: "Failed to load rate, using fallback.",
            days: [
                {
                    date: "Oct 7, Tuesday",
                    title: "Arrival & Settling In",
                    summary: "Arrive from Birmingham, check into your new place, and enjoy a relaxing evening stroll along the Thames.",
                    details: `
                        <h4 class="font-bold mb-2">Transportation:</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>Train:</b> Take the Avanti West Coast train from Birmingham New Street to London Euston Station (approx. 1.5-2 hours).</li>
                            <li><b>Tube:</b> From Euston, take the Northern Line to Old Street Station, then walk to Quaker Court on Banner Street.</li>
                            <li><b>Money-Saving Tip:</b> Book train tickets in advance and research "Split Ticketing" to save significantly.</li>
                        </ul>
                        <h4 class="font-bold mb-2">Evening Activity:</h4>
                        <p class="mb-4">After settling in, take a walk to the nearby Tower of London and Tower Bridge to admire their magnificent exteriors. Continue along the Thames to St. Katharine Docks and Butler's Wharf for a scenic first evening.</p>
                        <h4 class="font-bold mb-2">Dinner Recommendations:</h4>
                        <ul class="list-disc list-inside space-y-1">
                            <li><b>The Dickens Inn:</b> Enjoy classic British pub fare in a historic wooden building at St. Katharine Docks.</li>
                            <li><b>Wright Brothers:</b> A famous seafood restaurant near Butler's Wharf, known for its fresh oysters and seafood platters.</li>
                        </ul>
                    `
                },
                {
                    date: "Oct 8, Wednesday",
                    title: "Royalty, Shopping & Parks",
                    summary: "Watch the Changing of the Guard, stroll through royal parks, immerse yourself in art and design, and experience top-tier shopping. Dinner is at Burger and Lobster.",
                    details: `
                        <h4 class="font-bold mb-2">Morning: Buckingham Palace & Westminster</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>Transport:</b> Take the Tube from Westminster to South Kensington Station.</li>
                            <li><b>V&A Museum:</b> Explore world-leading collections of art and design (free, booking a free timed ticket online is recommended).</li>
                            <li><b>Harrods:</b> A short walk from the V&A, experience one of the world's most famous department stores.</li>
                        </ul>
                        <h4 class="font-bold mb-2">Dinner Reservation:</h4>
                        <p><b>Burger and Lobster</b> (Knightsbridge branch): Located directly opposite Harrods, this is a very convenient option for dinner. It's recommended to book in advance to secure a table.</p>
                    `
                },
                {
                    date: "Oct 9, Thursday",
                    title: "Culture, Academia & Theatre",
                    summary: "Immerse yourself in the vast collection of the British Museum, explore the West End, and enjoy a world-class musical at night.",
                    details: `
                        <h4 class="font-bold mb-2">Morning: The British Museum</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>Transport:</b> Take the Central Line from Liverpool Street to Tottenham Court Road Station.</li>
                            <li><b>Visit:</b> Explore world-class artifacts like the Rosetta Stone and Egyptian mummies (free, booking a free timed ticket online is recommended).</li>
                        </ul>
                        <h4 class="font-bold mb-2">Afternoon: West End Exploration</h4>
                        <p class="mb-4">From the British Museum, walk to explore the London School of Economics (LSE), enjoy some reading time at Foyles bookshop in Covent Garden, and wander through the vibrant streets of Soho.</p>
                        <h4 class="font-bold mb-2">Evening: Musical & Dinner</h4>
                        <ul class="list-disc list-inside space-y-1">
                             <li><b>Musical:</b> Enjoy the classic "The Phantom of the Opera". Book tickets in advance via the official website or apps like TodayTix.</li>
                             <li><b>Dinner Recommendation:</b> Choose a restaurant near Covent Garden or Soho, there are plenty of great options.</li>
                        </ul>
                    `
                },
                {
                    date: "Oct 10, Friday",
                    title: "Day Trip to Cambridge & Dinner",
                    summary: "A brief escape from the city to visit a world-class university and experience the unique charm of river punting. Dinner in London at night.",
                    details: `
                        <h4 class="font-bold mb-2">Transportation:</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>Train:</b> Take a direct train from London King's Cross Station to Cambridge (approx. 48 minutes).</li>
                            <li><b>Money-Saving Tip:</b> Use "split ticketing" strategies when booking in advance.</li>
                        </ul>
                        <h4 class="font-bold mb-2">Afternoon Activities:</h4>
                         <p class="mb-4">Upon arrival, visit the famous King's College and Trinity College, then experience the iconic River Cam punting to see landmarks like the Bridge of Sighs from the water.</p>
                        <h4 class="font-bold mb-2">Dining Recommendations:</h4>
                        <ul class="list-disc list-inside space-y-1">
                            <li><b>The Eagle:</b> A historic pub famous for its fish and chips and WWII history.</li>
                            <li><b>Fitzbillies:</b> Try their signature Chelsea Buns.</li>
                        </ul>
                        <h4 class="font-bold mb-2">Dinner Reservation:</h4>
                        <p><b>Sticks'n'Sushi - Islington</b>, Oct 10, 19:15, 4 people (Confirmed, Confirmation #: 19438).</p>
                    `
                },
                {
                    date: "Oct 11, Saturday",
                    title: "Art, Food & The South Bank",
                    summary: "Admire world-famous paintings, indulge in London's most renowned food market, and enjoy an evening walk along the South Bank.",
                    details: `
                        <h4 class="font-bold mb-2">Morning: The National Gallery</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>Transport:</b> Take the Tube from Liverpool Street to Charing Cross Station.</li>
                            <li><b>Visit:</b> Admire masterpieces by Van Gogh, Monet, and more (free, booking a free ticket online is recommended). Allow at least 3 hours.</li>
                        </ul>
                        <h4 class="font-bold mb-2">Afternoon: Borough Market & South Bank Stroll</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                             <li><b>Transport:</b> Take the Jubilee Line from Charing Cross to London Bridge Station.</li>
                            <li><b>Food Tour:</b> At Borough Market, try the sausage rolls, artisan cheese, fresh oysters, and 3bis gelato.</li>
                            <li><b>Stroll:</b> Walk west along the South Bank from Southwark to Waterloo, passing Shakespeare's Globe and Tate Modern.</li>
                        </ul>
                         <h4 class="font-bold mb-2">Dinner Reservation:</h4>
                        <p><b>Blacklock Shoreditch</b>, Oct 11, 19:45, 3 people (Confirmed, Confirmation #: 2109994835)</p>
                    `
                },
                {
                    date: "Oct 12, Sunday",
                    title: "Market & Departure",
                    summary: "Experience the multicultural vibe at East London's liveliest market before heading to the airport to conclude your trip.",
                    details: `
                        <h4 class="font-bold mb-2">Morning: 布里克巷市集</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>交通:</b> 从您的住所步行即可到达，非常便利。</li>
                            <li><b>亮点:</b> 周日的布里克巷(Brick Lane)市集最为热闹，充满了复古服饰、独立设计和世界各地的街头美食。</li>
                            <li><b>美食推荐:</b> 务必尝试Beigel Bake的咸牛肉贝果和地道的孟加拉国咖喱。</li>
                        </ul>
                        <h4 class="font-bold mb-2">下午活动: 前往机场</h4>
                        <ul class="list-disc list-inside mb-4 space-y-1">
                            <li><b>时间规划:</b> 您的航班CX250于18:20从希思罗机场T3航站楼起飞。建议最晚于15:00从住所出发。</li>
                            <li><b>交通:</b> 从利物浦街站乘坐伊丽莎白线(Elizabeth Line)直达希思罗机场 (约35分钟)。</li>
                        </ul>
                    `
                },
            ]
        }
    };

    let currentLang = 'zh';
    let exchangeRate = 9.2; // Fallback rate

    const itineraryGrid = document.getElementById('itinerary-grid');
    const mainTitleEl = document.getElementById('main-title');
    const langToggleBtn = document.getElementById('lang-toggle');
    const toolsTitleEl = document.getElementById('tools-title');
    const converterTitleEl = document.getElementById('converter-title');
    const rateDisplayEl = document.getElementById('rate-display');
    const gbpInput = document.getElementById('gbp-input');
    const cnyOutput = document.getElementById('cny-output');

    // 随机生成一个鲜艳的颜色
    function getRandomColor() {
        const hue = Math.floor(Math.random() * 360);
        return `hsl(${hue}, 80%, 50%)`;
    }

    // 计算文字颜色以确保与背景高对比度
    function getTextColor(bgColor) {
        // Simple luminance check for an HSL color string
        const l = parseInt(bgColor.substring(bgColor.lastIndexOf(',') + 2, bgColor.indexOf('%)')));
        return l < 50 ? 'white' : '#333';
    }

    function createDayCard(day, index) {
        const bgColor = getRandomColor();
        const textColor = (index === 0 || index === 1 || index === 3 || index === 4) ? 'white' : getTextColor(bgColor);

        const card = document.createElement('div');
        card.className = "card rounded-2xl shadow-lg overflow-hidden transition-all duration-300 hover:shadow-2xl cursor-pointer";
        card.style.backgroundColor = bgColor;
        card.style.color = textColor;
        card.dataset.index = index;

        const cardHeader = document.createElement('div');
        cardHeader.className = 'p-6 flex justify-between items-center';
        
        const headerText = document.createElement('div');
        const dateEl = document.createElement('p');
        dateEl.className = 'text-sm font-semibold opacity-80';
        dateEl.dataset.key = 'date';
        const titleEl = document.createElement('h3');
        titleEl.className = 'text-xl font-bold mt-1';
        titleEl.dataset.key = 'title';
        headerText.appendChild(dateEl);
        headerText.appendChild(titleEl);

        const arrow = document.createElement('div');
        arrow.className = 'arrow-icon';
        arrow.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>`;
        arrow.querySelector('svg').style.color = textColor;
        
        cardHeader.appendChild(headerText);
        cardHeader.appendChild(arrow);
        
        const cardDetails = document.createElement('div');
        cardDetails.className = 'card-details text-sm opacity-90';
        const detailsContent = document.createElement('div');
        detailsContent.dataset.key = 'details';
        cardDetails.appendChild(detailsContent);

        const summaryEl = document.createElement('p');
        summaryEl.className = 'px-6 pb-6 font-medium opacity-90';
        summaryEl.dataset.key = 'summary';

        card.appendChild(cardHeader);
        card.appendChild(summaryEl);
        card.appendChild(cardDetails);

        itineraryGrid.appendChild(card);
    }

    function updateContent() {
        const langData = translations[currentLang];
        mainTitleEl.textContent = langData.mainTitle;
        langToggleBtn.textContent = langData.langButton;
        toolsTitleEl.textContent = langData.toolsTitle;
        converterTitleEl.textContent = langData.converterTitle;

        document.querySelectorAll('.card').forEach((card, index) => {
            const dayData = langData.days[index];
            card.querySelector('[data-key="date"]').textContent = dayData.date;
            card.querySelector('[data-key="title"]').textContent = dayData.title;
            card.querySelector('[data-key="summary"]').textContent = dayData.summary;
            card.querySelector('[data-key="details"]').innerHTML = dayData.details;
        });
        
        updateRateDisplay();
    }
    
    function updateRateDisplay() {
        if (rateDisplayEl.dataset.error) {
            rateDisplayEl.textContent = translations[currentLang].rateError;
        } else if (rateDisplayEl.dataset.loading === 'false') {
            rateDisplayEl.textContent = translations[currentLang].rateLoaded(exchangeRate);
        } else {
            rateDisplayEl.textContent = translations[currentLang].rateLoading;
        }
    }

    async function fetchExchangeRate() {
        rateDisplayEl.dataset.loading = 'true';
        updateRateDisplay();
        try {
            await new Promise(resolve => setTimeout(resolve, 1500));
            if (Math.random() > 0.95) {
                 throw new Error("API failed");
            }
            exchangeRate = 9.15 + Math.random() * 0.2;
            rateDisplayEl.dataset.loading = 'false';
            rateDisplayEl.dataset.error = 'false';
        } catch (error) {
            console.error("Failed to fetch live exchange rate:", error);
            rateDisplayEl.dataset.loading = 'false';
            rateDisplayEl.dataset.error = 'true';
        }
        updateRateDisplay();
        convertCurrency();
    }
    
    function convertCurrency() {
        const gbpValue = parseFloat(gbpInput.value);
        if (!isNaN(gbpValue)) {
            cnyOutput.value = (gbpValue * exchangeRate).toFixed(2);
        } else {
            cnyOutput.value = '';
        }
    }

    // Event Listeners
    langToggleBtn.addEventListener('click', () => {
        currentLang = currentLang === 'zh' ? 'en' : 'zh';
        updateContent();
    });

    itineraryGrid.addEventListener('click', (e) => {
        const card = e.target.closest('.card');
        if (card) {
            card.classList.toggle('active');
        }
    });

    gbpInput.addEventListener('input', convertCurrency);

    // Initial setup
    translations.zh.days.forEach((day, index) => createDayCard(day, index));
    updateContent();
    fetchExchangeRate();

});
</script>
</body>
</html>
